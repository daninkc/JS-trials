 <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      html, body {
          margin: 0!important;
          padding: 0!important;
      }
  </style>
  
  <title>Gif Recording | RecordRTC</title>
  <h1>Simple Gif Recording using RecordRTC</h1>
  
  <br>
  
  <button id="btn-start-recording">Start Recording</button>
  <button id="btn-stop-recording">Stop Recording</button>
  <button id="btn-upload">Upload</button>

  
  <hr>
  <div class="previewContainer"><img class="preview" id="videocontainer"></div>
  
  <script
src="https://cdnjs.cloudflare.com/ajax/libs/RecordRTC/5.5.8/R
ecordRTC.js" type="text/javascript"></script>
  <script>
  var image = document.getElementById('videocontainer');
  
  function captureCamera(callback) {
      navigator.mediaDevices.getUserMedia({ video: true }).then(function(stream) {
          callback(stream);
      }).catch(function(error) {
          alert('Unable to capture your camera. Please check console logs.');
          console.error(error);
      });
  }
  
  function stopRecordingCallback() {
      document.querySelector('h1').innerHTML = 'Gif recording stopped: ' + bytesToSize(recorder.getBlob().size);
      image.src = URL.createObjectURL(recorder.getBlob());
      let form = new FormData();
      form.append('file', recorder.getBlob(), 'myGif.gif');
      console.log(form.get('file'));
      
      document.getElementById("btn-upload").onclick = function() {

        fetch('upload.giphy.com/v1/gifs?api_key=pMoUhdb6YnPWGVLjL2eSH0j3IlnPzhGH', {
               method: "POST",
                 body: form
                  })
    .then(response => {
        console.log(response.status);
        return response.json();
      })


                }


      localStorage.setItem("danisgif", JSON.stringify(recorder));



      recorder.stream.stop();
      recorder = null;
  }
  
  
  var recorder; // globally accessible
  
  document.getElementById('btn-start-recording').onclick = function() {
      captureCamera(function(stream) {
          document.querySelector('h1').innerHTML = 'Waiting for Gif Recorder to start...';
          recorder = RecordRTC(stream, {
              type: 'gif',
              frameRate: 1,
              quality: 10,
              width: 360,
              hidden: 240,
              onGifRecordingStarted: function() {
                  document.querySelector('h1').innerHTML = 'Gif recording started.';
              },

              onGifPreview: function(gifURL) {
                  image.src = gifURL;
              }
          });
  
          recorder.startRecording();

  
          // release camera on stopRecording
          recorder.stream = stream;
  
          document.getElementById('btn-stop-recording').disabled = false;
      });
  };
  
  document.getElementById('btn-stop-recording').onclick = function() {
      this.disabled = false;
      recorder.stopRecording(stopRecordingCallback);
  };
  

  </script>
  

  </body>
</html>